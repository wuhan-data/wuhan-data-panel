<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
    <mapper namespace="com.wuhan_data.app.mapper.IndiDetailMapper">
       
<!--          获得搜索的所有指标来源 -->
<!--         <select id="getFreqCodeByIndiName" resultType="String" parameterType="String"> -->
<!--             select freq_code from  indi_all where indi_name= #{appIndiName}  group by freq_code    -->
<!--         </select> -->
        
<!-- 		 <select id="indiDateByFreqName" resultType="String" parameterType="java.util.Map" > -->
<!--             select date_code from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} group by date_code  -->
<!--         </select>  -->
        
<!--          <select id="getIndiValue" resultType="TPIndiValue" parameterType="java.util.Map" > -->
<!--             select indi_value,time_point from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} and  date_code &lt;= #{endTime} and date_code &gt;= #{startTime} -->
<!--         </select>  -->








  		<select id="getFreqCodeByIndiName" resultType="String" parameterType="String">
<!--   		and group_count=0 -->
            select freq_code from  MIDUSER."DT_EXP_ALL_SJLY" where indi_code=#{indexCode} and sjly_code2='3' and area_name='湖北省'  and (time_point = '104' or time_point = '203') and lj=#{lj} group by freq_code   
        </select>
        <select id="getFreqCodeByIndiNameArea" resultType="String" parameterType="java.util.Map">
            select freq_code from  MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and sjly_code2='3' and lj=#{lj} and area_code &lt; '430000000000' and area_code &gt; '420000000000' and (time_point = '104' or time_point = '203') group by freq_code   
        </select>
        
		<select id="getFreqCodeByIndiNameG" resultType="String" parameterType="java.util.Map">
            select freq_code from  MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and sjly_code2='1' and (time_point = '104' or time_point = '203') and area_name=#{area_name} and lj=#{lj} group by freq_code   
        </select>
        
		 <select id="indiDateByFreqName" resultType="String" parameterType="java.util.Map" >
<!-- 		 and group_count=0 -->
            select date_code from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and freq_code=#{freqCode} and sjly_code2='3'  and area_name='湖北省' and (time_point = '104' or time_point = '203') and lj=#{lj} group by date_code 
        </select> 
         <select id="indiDateByFreqNameArea" resultType="String" parameterType="java.util.Map" >
            select date_code from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and freq_code=#{freqCode} and sjly_code2='3' and lj=#{lj} and (time_point = '104' or time_point = '203') and area_code &lt; '430000000000' and area_code &gt; '420000000000' group by date_code 
        </select> 
        <select id="indiDateByFreqNameDefault" resultType="String" parameterType="java.util.Map" >
            select date_code from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and freq_code=#{freqCode} and sjly_code2='3' and lj=#{lj} and (time_point = '104' or time_point = '203') and area_code &lt; '430000000000' and area_code &gt; '420000000000' group by date_code 
        </select>
        
        <select id="getIndiAreaList" resultType="String" parameterType="java.util.Map" >
            select area_name from MIDUSER."DT_EXP_ALL_SJLY" where indi_name= #{appIndiName} and freq_code=#{freqCode} and sjly_name2='湖北省统计局' and group_count=0 and lj=#{lj} and (time_point = '104' or time_point = '203') and area_code &lt; '430000000000' and area_code &gt; '420000000000' group by area_name 
        </select> 
        
 		<select id="indiDateByFreqNameG" resultType="String" parameterType="java.util.Map" >
           select date_code from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and freq_code=#{freqCode} and sjly_code2='1' and (time_point = '104' or time_point = '203') and area_name=#{area_name} and lj=#{lj} group by date_code 
        </select> 
        
        <select id="indiDateByFreqNameG1" resultType="String" parameterType="java.util.Map" >
            select data_time_name from PLATFORM1."SRIT_DATA_INDICATOR_TJ" where indi_name_ch= #{appIndiName} and indicator_grp21_item_name=#{freqCode} and indexdataid=#{indexCode}  group by data_time_name 
        </select> 
        
         <select id="getIndiValue" resultType="TPIndiValue" parameterType="java.util.Map" >
            select indi_value,time_point,date_code from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and area_name='湖北省' and freq_code=#{freqCode} and date_code &lt;= #{endTime} and date_code &gt;= #{startTime} and sjly_code2='3' and (time_point = '104' or time_point = '203')  and lj=#{lj}
        </select> 
 		<select id="getIndiValueG" resultType="TPIndiValue" parameterType="java.util.Map" >
            select indi_value,date_code,time_point from MIDUSER."DT_EXP_ALL_SJLY" where indi_code=#{indexCode} and freq_code=#{freqCode} and date_code &lt;= #{endTime} and date_code &gt;= #{startTime} and sjly_code2='1' and (time_point = '104' or time_point = '203')  and lj=#{lj} and area_name=#{area_name}
<!--              and indicator_grp23_item_name=#{area_name} -->
        </select> 
       <select id="getIndiValueArea" resultType="TPIndiValue" parameterType="java.util.Map" >
            select indi_value,time_point,date_code,area_name from MIDUSER."DT_EXP_ALL_SJLY" where indi_code= #{indexCode} and freq_code=#{freqCode} and date_code= #{time} and (time_point = '104' or time_point = '203')  and lj=#{lj} and area_code &lt; '430000000000' and area_code &gt; '420000000000' and sjly_code2='3'
        </select> 
      
       <insert id="indiCollect" parameterType="Collect" >
            insert into WUHAN_DATA."COLLECT"(uid,type,index_id,index_name,create_time,indi_source)values (#{uid},#{type},#{index_id},#{index_name},#{create_time},#{indi_source})
        </insert>
        
        <select id="getIndiShowType" resultType="String" parameterType="java.util.Map" >
            select show_type from WUHAN_DATA."INDEX_MANAGE" where indi_name=#{appIndiName} and source=#{source}
        </select> 
        <select id="getIndiCode" resultType="String" parameterType="java.util.Map" >
            select indi_code from MIDUSER."APP_SEARCH_INDI" where indi_old_name=#{indi_name} and  lj=#{lj} group by indi_code
        </select> 
        <select id="getIndiCodeG" resultType="String" parameterType="java.util.Map" >
            select indi_code from MIDUSER."APP_SEARCH_INDI" where indi_old_name=#{indi_name} and lj=#{lj} and area_name='全国' group by indi_code
        </select> 
        
        
         <select id="getIndexName" resultType="String" parameterType="String" >
            select indi_old_name from MIDUSER."APP_SEARCH_INDI" where indi_code=#{indexCode} and sjly_code2='1' group by indi_old_name
        </select>
        <select id="getIndexNameH" resultType="String" parameterType="String" >
            select indi_old_name from MIDUSER."APP_SEARCH_INDI" where indi_code=#{indexCode} and source='湖统' group by indi_old_name limit 1
        </select>
        
         <select id="getIsFavorite" resultType="int" parameterType="java.util.Map" >
            select count(*) from WUHAN_DATA."COLLECT" where index_name=#{appIndiName} and uid=#{userId} and indi_source=#{source} and type='指标数据'
        </select>
        
         <select id="getIndexStatus" resultType="int" parameterType="java.util.Map" >
            select status from WUHAN_DATA."INDEX_MANAGE" where indi_name=#{indi_name} and source=#{source}
        </select>
        
        <select id="getAreaNameListG" resultType="String" parameterType="java.util.Map" >
            select indicator_grp23_item_name from PLATFORM1."SRIT_DATA_INDICATOR_TJ" where indi_name_ch= #{appIndiName} and indicator_grp21_item_name=#{freqCode} group by indicator_grp23_item_name 
        </select> 
        
    </mapper>
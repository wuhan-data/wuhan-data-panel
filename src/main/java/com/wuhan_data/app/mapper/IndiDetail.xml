<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
    <mapper namespace="com.wuhan_data.app.mapper.IndiDetailMapper">
       
<!--          获得搜索的所有指标来源 -->
<!--         <select id="getFreqCodeByIndiName" resultType="String" parameterType="String"> -->
<!--             select freq_code from  indi_all where indi_name= #{appIndiName}  group by freq_code    -->
<!--         </select> -->
        
<!-- 		 <select id="indiDateByFreqName" resultType="String" parameterType="java.util.Map" > -->
<!--             select date_code from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} group by date_code  -->
<!--         </select>  -->
        
<!--          <select id="getIndiValue" resultType="TPIndiValue" parameterType="java.util.Map" > -->
<!--             select indi_value,time_point from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} and  date_code &lt;= #{endTime} and date_code &gt;= #{startTime} -->
<!--         </select>  -->








  		<select id="getFreqCodeByIndiName" resultType="String" parameterType="String">
            select INDICATOR_GRP21_ITEM_NAME as freq_code from  PLATFORM1."SRIT_DATA_INDICATOR_TJ" where INDI_NAME_CH= #{appIndiName} and INDICATOR_GRP20_ITEM_NAME=#{source} and INDICATOR_GRP23_ITEM_NAME=#{area_name} group by INDICATOR_GRP21_ITEM_NAME   
        </select>
<!-- 		<select id="getFreqCodeByIndiName" resultType="String" parameterType="String"> -->
<!--             select freq_code from  indi_all where indi_name= #{appIndiName} and sjly=#{source} group by freq_code    -->
<!--         </select> -->
        
		 <select id="indiDateByFreqName" resultType="String" parameterType="java.util.Map" >
            select DATA_TIME_NAME as date_code from PLATFORM1."SRIT_DATA_INDICATOR_TJ" where INDI_NAME_CH= #{appIndiName} and INDICATOR_GRP21_ITEM_NAME=#{freqCode} and INDICATOR_GRP20_ITEM_NAME=#{source} and INDICATOR_GRP23_ITEM_NAME=#{area_name} group by DATA_TIME_NAME 
        </select> 
<!--  		<select id="indiDateByFreqName" resultType="String" parameterType="java.util.Map" > -->
<!--             select date_code from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} and sjly=#{source} group by date_code  -->
<!--         </select>  -->
        
         <select id="getIndiValue" resultType="TPIndiValue" parameterType="java.util.Map" >
            select VALUE as indi_value,DATA_TIME_NAME as date_code from PLATFORM1."SRIT_DATA_INDICATOR_TJ" where INDI_NAME_CH= #{appIndiName} and INDICATOR_GRP23_ITEM_NAME=#{area_name} and INDICATOR_GRP21_ITEM_NAME=#{freqCode} and DATA_TIME_NAME &lt;= #{endTime} and DATA_TIME_NAME &gt;= #{startTime} and INDICATOR_GRP20_ITEM_NAME=#{source}
        </select> 
<!--  		<select id="getIndiValue" resultType="TPIndiValue" parameterType="java.util.Map" > -->
<!--             select indi_value,time_point,date_code from indi_all where indi_name= #{appIndiName} and freq_code=#{freqCode} and date_code &lt;= #{endTime} and date_code &gt;= #{startTime} and sjly=#{source} -->
<!--         </select>  -->
      
      
       <insert id="indiCollect" parameterType="Collect" >
            insert into WUHAN_DATA."COLLECT"(uid,type,index_id,index_name,create_time,indi_source)values (#{uid},#{type},#{index_id},#{index_name},#{create_time},#{indi_source})
        </insert>
        
        <select id="getIndiShowType" resultType="String" parameterType="java.util.Map" >
            select show_type from WUHAN_DATA."INDEX_MANAGE" where indi_name=#{appIndiName} and source=#{source}
        </select> 
        <select id="getIndiCode" resultType="String" parameterType="String" >
            select indi_code from WUHAN_DATA."INDEX_MANAGE" where indi_name=#{appIndiName} group by indi_code
        </select> 
         <select id="getIndexName" resultType="String" parameterType="String" >
            select indi_name from WUHAN_DATA."INDEX_MANAGE" where indi_code=#{indexCode} group by indi_name
        </select>
        
         <select id="getIsFavorite" resultType="int" parameterType="java.util.Map" >
            select count(*) from WUHAN_DATA."COLLECT" where index_name=#{appIndiName} and uid=#{userId} and type='指标数据'
        </select>
        
         <select id="getIndexStatus" resultType="int" parameterType="java.util.Map" >
            select status from WUHAN_DATA."INDEX_MANAGE" where indi_name=#{indi_name} and source=#{source}
        </select>
        
    </mapper>
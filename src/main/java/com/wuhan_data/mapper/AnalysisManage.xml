<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
    <mapper namespace="com.wuhan_data.mapper.AnalysisManageMapper">
    
    <!-- 达梦数据库 -->
    
    <select id="groupList" resultType="AnalysisLabel" parameterType="java.util.Map" >      
             select label_id ,type_id,label_name,label_weight,is_show from WUHAN_DATA."ANALYSIS_LABEL"
            <where>
            	type_id=#{type_id}
            </where>
            order by label_weight 
        </select> 
        
        <!-- 添加二级分类 -->
        <insert id="addLabel" parameterType="AnalysisLabel" >
            insert into WUHAN_DATA."ANALYSIS_LABEL"(type_id,label_name,label_weight) values(#{type_id},#{label_name},#{label_weight})
        </insert>
        
        <!-- 修改二级分类 -->
        <update id="editLabel" parameterType="AnalysisLabel">
        update WUHAN_DATA."ANALYSIS_LABEL"
        <set>
            <if test="label_name!=null">label_name=#{label_name}</if>
        </set>
        where label_id=#{label_id}
        </update>
        
        <!-- 删除二级分类 -->
        <delete id="delete" parameterType="int" >
            delete from WUHAN_DATA."ANALYSIS_LABEL" where label_id=#{label_id}
        </delete>
        
        <!-- 二级分类是否显示 -->
        <update id="updateShow" parameterType="AnalysisLabel">
        update WUHAN_DATA."ANALYSIS_LABEL"
        <set>
            <if test="is_show!=null">is_show=#{is_show}</if>
        </set>
        where label_id=#{label_id}
        </update>
        
        <select id="getMaxWeight" resultType="int" parameterType="int" >
           select max(label_weight)+1 from WUHAN_DATA."ANALYSIS_LABEL" where type_id=#{type_id}
        </select> 
        
        <select id="getLabelId" resultType="int" parameterType="Map">     
           select label_id from WUHAN_DATA."ANALYSIS_LABEL"  where type_id=#{type_id} and label_weight=#{oldWeight}
        </select>
        
        <update id="updateWeight" parameterType="Map" >
            update WUHAN_DATA."ANALYSIS_LABEL"
            <set>
            label_weight=#{newWeight}
            </set>
             where label_id=#{label_id}
        </update>
        
        
        
         <update id="reOrderByTypename" parameterType="AnalysisType">
        update WUHAN_DATA."ANALYSIS_TYPE"
        <set>
            <if test="type_weight!=null">type_weight=#{type_weight}</if>
        </set>
        where type_name=#{type_name}
        </update>        
         
        
         
        <select id="get" parameterType="int" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from WUHAN_DATA."ANALYSIS_THEME" where theme_id=#{id}   
        </select>
        
         <select id="weight" parameterType="String" resultType="int">
            select distinct type_weight from WUHAN_DATA."ANALYSIS_THEME" where type_name=#{tname}   
        </select>
        
       <select id="getOrderByTypename"  resultType="AnalysisType">
            select type_name,type_weight from WUHAN_DATA."ANALYSIS_TYPE" where type_weight&lt;11 order by type_weight desc
        </select>
 
  		<select id="search" parameterType="java.util.Map" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from WUHAN_DATA."ANALYSIS_THEME" 
            <where>
            theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name} 
            </where>
             order by theme_id limit #{page.dbIndex},#{page.dbNumber}
        </select>

        
        <select id="list" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from WUHAN_DATA."ANALYSIS_THEME"   
        </select> 
        
        <select id="parentList" resultType="AnalysisType" >
            select type_id,type_name,type_weight from WUHAN_DATA."ANALYSIS_TYPE" order by type_weight desc
        </select> 
        
        <select id="countByGroup" resultType="int" parameterType="String" >
            select count(*) from WUHAN_DATA."ANALYSIS_LABEL" where type_id=#{type_id}
        </select>
        
        <select id="getFirstWeight" resultType="AnalysisType" >
            select type_id,type_name from WUHAN_DATA."ANALYSIS_TYPE" where type_weight=1
        </select>  
       
         <select id="searchCount" resultType="int" parameterType="java.util.Map" >
            select count(*) from WUHAN_DATA."ANALYSIS_THEME" where theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name} 
        </select>
              
         <select id="searchGroupList" resultType="AnalysisManage" parameterType="java.util.Map" >
            select theme_id id,type_name,theme_name,type_weight weight,is_show from WUHAN_DATA."ANALYSIS_THEME"
            <where>
            theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name}
            </where>
            order by theme_id limit #{page.dbIndex},#{page.dbNumber}
        </select> 
        
        <select id="getTypeId" resultType="int" parameterType="String" >
            select type_id from WUHAN_DATA."ANALYSIS_TYPE" where type_name=#{type_name}
        </select> 
    
    
    <!-- mysql数据库 -->
    
     	<!-- <select id="groupList" resultType="AnalysisLabel" parameterType="java.util.Map" >
            select theme_id id,type_name,theme_name,type_weight weight,is_show from analysis_theme
            <where>
            	type_name=#{type_name}
            </where>
            order by theme_id limit #{page.dbIndex},#{page.dbNumber}
            
             select label_id ,type_id,label_name,label_weight,is_show from analysis_label
            <where>
            	type_id=#{type_id}
            </where>
            order by label_weight limit #{page.dbIndex},#{page.dbNumber}
        </select> 
        
        添加二级分类
        <insert id="addLabel" parameterType="AnalysisLabel" >
            insert into analysis_label(type_id,label_name,label_weight) values(#{type_id},#{label_name},#{label_weight})
        </insert>
        
        修改二级分类
        <update id="editLabel" parameterType="AnalysisLabel">
        update analysis_label
        <set>
            <if test="label_name!=null">label_name=#{label_name}</if>
        </set>
        where label_id=#{label_id}
        </update>
        
        删除二级分类
        <delete id="delete" parameterType="int" >
            delete from analysis_label where label_id=#{label_id}
        </delete>
        
        二级分类是否显示
        <update id="updateShow" parameterType="AnalysisLabel">
        update analysis_label
        <set>
            <if test="is_show!=null">is_show=#{is_show}</if>
        </set>
        where label_id=#{label_id}
        </update>
        
        <select id="getMaxWeight" resultType="int" parameterType="int" >
           select max(label_weight)+1 from analysis_label where type_id=#{type_id}
        </select> 
        
        <select id="getLabelId" resultType="int" parameterType="Map">     
           select label_id from ANALYSIS_LABEL  where type_id=#{type_id} and label_weight=#{oldWeight}
        </select>
        
        <update id="updateWeight" parameterType="Map" >
            update ANALYSIS_LABEL
            <set>
            label_weight=#{newWeight}
            </set>
             where label_id=#{label_id}
        </update>
        
        
        
         <update id="reOrderByTypename" parameterType="AnalysisType">
        update analysis_type
        <set>
            <if test="type_weight!=null">type_weight=#{type_weight}</if>
        </set>
        where type_name=#{type_name}
        </update>        
         
        
         
        <select id="get" parameterType="int" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from analysis_theme where theme_id=#{id}   
        </select>
        
         <select id="weight" parameterType="String" resultType="int">
            select distinct type_weight from analysis_theme where type_name=#{tname}   
        </select>
        
       <select id="getOrderByTypename"  resultType="AnalysisType">
            select type_name,type_weight from analysis_type where type_weight&lt;11 order by type_weight desc
        </select>
 
  		<select id="search" parameterType="java.util.Map" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from analysis_theme 
            <where>
            theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name} 
            </where>
             order by theme_id limit #{page.dbIndex},#{page.dbNumber}
        </select>

        
        <select id="list" resultType="AnalysisManage">
            select theme_id id,type_name,theme_name,type_weight weight,is_show from analysis_theme   
        </select> 
        
        <select id="parentList" resultType="AnalysisType" >
            select type_id,type_name,type_weight from analysis_type order by type_weight desc
        </select> 
        
        <select id="countByGroup" resultType="int" parameterType="String" >
            select count(*) from analysis_label where type_id=#{type_id}
        </select>
        
        <select id="getFirstWeight" resultType="AnalysisType" >
            select type_id,type_name from analysis_type where type_weight=1
        </select>  
       
         <select id="searchCount" resultType="int" parameterType="java.util.Map" >
            select count(*) from analysis_theme where theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name} 
        </select>
              
         <select id="searchGroupList" resultType="AnalysisManage" parameterType="java.util.Map" >
            select theme_id id,type_name,theme_name,type_weight weight,is_show from analysis_theme
            <where>
            theme_name like concat(concat('%',#{theme_name}),'%') and type_name=#{type_name}
            </where>
            order by theme_id limit #{page.dbIndex},#{page.dbNumber}
        </select> 
        
        <select id="getTypeId" resultType="int" parameterType="String" >
            select type_id from analysis_type where type_name=#{type_name}
        </select>  -->


       
       
       
       
       
       
    </mapper>
